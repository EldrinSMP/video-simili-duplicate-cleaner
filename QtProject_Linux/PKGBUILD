# PKGBUILD

# Use environment variables passed from the build script
pkgname="${CI_PACKAGE_NAME:-video-simili-duplicate-cleaner}"
_pkgver="${CI_PACKAGE_VERSION:-r0.local}"
pkgver=${_pkgver//-/_} # Replace hyphens for Arch versioning rules
pkgrel=1
pkgdesc="A utility to find duplicate and similar videos"
arch=("$CI_PACKAGE_ARCH") # Set architecture dynamically
url="https://github.com/EldrinSMP/video-simili-duplicate-cleaner"
license=('GPL3')
depends=('qt6-base' 'opencv' 'ffmpeg')
makedepends=('cmake' 'git')
source=("$pkgname::git+$url.git")
sha256sums=('SKIP')

build() {
  cd "$pkgname"
  cmake -S QtProject_Linux -B build -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr
  cmake --build build
}

package() {
  cd "$pkgname"
  DESTDIR="$pkgdir" cmake --install build
}
